
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>2.4. 베르누이분포와 이항분포 &#8212; 데이터 사이언스 스쿨 - 데이터 분석 편</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=62ba249389abaaa9ffc34bf36a076bdc1d65ee18" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=f31d14ad54b65d19161ba51d4ffff3a77ae00456"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script kind="utterances">

    var commentsRunWhenDOMLoaded = cb => {
    if (document.readyState != 'loading') {
        cb()
    } else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', cb)
    } else {
        document.attachEvent('onreadystatechange', function() {
        if (document.readyState == 'complete') cb()
        })
    }
}

var addUtterances = () => {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src = "https://utteranc.es/client.js";
    script.async = "async";

    script.setAttribute("repo", "datascienceschool/book_data_analysis");
    script.setAttribute("issue-term", "pathname");
    script.setAttribute("theme", "github-light");
    script.setAttribute("label", "💬 comment");
    script.setAttribute("crossorigin", "anonymous");

    sections = document.querySelectorAll("div.section");
    if (sections !== null) {
        section = sections[sections.length-1];
        section.appendChild(script);
    }
}
commentsRunWhenDOMLoaded(addUtterances);
</script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.5. 카테고리분포와 다항분포" href="02_05.html" />
    <link rel="prev" title="2.3. 확률분포모형을 사용한 확률분포추정" href="02_03.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">데이터 사이언스 스쿨 - 데이터 분석 편</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    데이터 사이언스 스쿨 - 데이터 분석 편
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ch01/01_00.html">
   1. 데이터 분석의 소개
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01/01_01.html">
     1.1. 이 책에서 다루는 데이터 분석이란?
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01/01_02.html">
     1.2. 데이터 분석을 위한 도구의 소개
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch01/01_03.html">
     1.3. 예제 데이터
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="02_00.html">
   2. 모수추정과 검정 - 데이터의 신뢰도를 분석한다
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="02_01.html">
     2.1. 확률적 데이터
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_02.html">
     2.2. 시각적 확률분포추정
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_03.html">
     2.3. 확률분포모형을 사용한 확률분포추정
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     2.4. 베르누이분포와 이항분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_05.html">
     2.5. 카테고리분포와 다항분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_06.html">
     2.6. 정규분포, 로그정규분포, 스튜던트t분포
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_07.html">
     2.7. 최대가능도추정
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02_08.html">
     2.8. EDA: 탐색적 데이터 분석
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../ch03/03_00.html">
   3. 회귀분석 - 수치형 데이터의 상관관계를 분석한다
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03/03_01.html">
     3.1. 상관관계
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03/03_02.html">
     3.2. 회귀분석
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03/03_03.html">
     3.3. 회귀분석을 위한 준비
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../ch03/03_04.html">
     3.4. 선형 회귀분석 모형
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/datascienceschool/book_data_analysis/main?urlpath=tree/./ch02/02_04.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>
<a href="https://github.com/datascienceschool/book_data_analysis"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="bottom"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/ch02/02_04.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   2.4.1. 베르누이분포
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     2.4.1.1. 베르누이분포의 확률분포함수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     2.4.1.2. 베르누이 분포의 시뮬레이션
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     2.4.1.3. 베르누이분포의 예
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     2.4.1.4. 베르누이분포의 모수추정
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     2.4.1.5. 신뢰구간
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     2.4.1.6. 모수검정
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   2.4.2. 이항분포
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     2.4.2.1. 이항분포의 확률분포함수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     2.4.2.2. 이항분포의 시뮬레이션
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     2.4.2.3. 이항분포와 베르누이분포의 비교
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     2.4.2.4. 이항분포의 예
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     2.4.2.5. 이항분포의 모수추정
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>베르누이분포와 이항분포</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   2.4.1. 베르누이분포
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     2.4.1.1. 베르누이분포의 확률분포함수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     2.4.1.2. 베르누이 분포의 시뮬레이션
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     2.4.1.3. 베르누이분포의 예
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     2.4.1.4. 베르누이분포의 모수추정
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     2.4.1.5. 신뢰구간
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     2.4.1.6. 모수검정
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id9">
   2.4.2. 이항분포
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id10">
     2.4.2.1. 이항분포의 확률분포함수
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id11">
     2.4.2.2. 이항분포의 시뮬레이션
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id12">
     2.4.2.3. 이항분포와 베르누이분포의 비교
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id13">
     2.4.2.4. 이항분포의 예
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id14">
     2.4.2.5. 이항분포의 모수추정
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1><span class="section-number">2.4. </span>베르누이분포와 이항분포<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h1>
<section id="id2">
<h2><span class="section-number">2.4.1. </span>베르누이분포<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h2>
<p><b>베르누이분포(bernoulli distribution)</b>는 값이 두가지로만 나오는 범주값 확률변수의 확률분포다. 예를 들어 동전을 한 번 던졌을 때 앞면 혹은 뒷면이 나오는 것은 베르누이분포를 따르는 확률변수다. 또한 앞 절에서 설명한 팁 데이터에서 성별을 나타내는 sex 필드나 흡연유무를 나타내는 smoker 필드, 그리고 점심/저녁을 나타내는 time 필드는 모두 베르누이분포를 따른다고 할 수 있다. 베르누이분포의 값은 성별일 경우 “Male/Female”, 흡연유무를 나타내는 경우 “Yes/No”같이 문자열이 되는 경우가 많지만 수학적 모형을 위해 이 값을 0과 1이라는 숫자로 바꾸어서 사용하는 경우가 보통이다. 어느 값을 0으로 하고 어느 값을 1로 할지는 분석하는 사람의 마음대로다.</p>
<section id="id3">
<h3><span class="section-number">2.4.1.1. </span>베르누이분포의 확률분포함수<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>확률변수 <span class="math notranslate nohighlight">\(x\)</span>가 베르누이분포를 따르는 경우 다음과 같이 표시한다.</p>
<div class="math notranslate nohighlight">
\[ x \sim \text{Bern}(x) \]</div>
<p>위 식에서 <span class="math notranslate nohighlight">\(\text{Bern}(x)\)</span>은 베르누이분포의 확률질량함수를 가리키는 기호다.</p>
<p>베르누이분포의 확률질량함수 <span class="math notranslate nohighlight">\(\text{Bern}(x)\)</span>의 수식은 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
\begin{align}
\text{Bern}(x;\mu) = 
\begin{cases} 
\mu   &amp; \text{if }x=1, \\
1-\mu &amp; \text{if }x=0
\end{cases}
\end{align}
\end{split}
\end{split}\]</div>
<p>이 식에서 <span class="math notranslate nohighlight">\(x\)</span>의 값이 1이 될 확률을 <span class="math notranslate nohighlight">\(\mu\)</span>라는 기호로 표시한다. <span class="math notranslate nohighlight">\(x\)</span>의 값이 0이 될 확률은 <span class="math notranslate nohighlight">\(1-\mu\)</span>가 된다. 위 식에서 베르누이분포의 모수는 <span class="math notranslate nohighlight">\(\mu\)</span> 하나만 있다는 것을 알 수 있다. 모수는 위 식에서 표시하였듯이 확류변수의 값 기호 <span class="math notranslate nohighlight">\(x\)</span> 오른쪽에 세미콜론(;) 기호를 붙이고 그 옆에 표시한다. 만약 1과 0이 나올 확률이 같다면 <span class="math notranslate nohighlight">\(\mu=0.5\)</span>가 되므로 다음과 같이 쓸 수 있다.</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{split}
\begin{align}
\text{Bern}(x;\mu) = 
\begin{cases} 
0.5   &amp; \text{if }x=1, \\
0.5 &amp; \text{if }x=0
\end{cases}
\end{align}
\end{split}
\end{split}\]</div>
<p>확률질량함수 <span class="math notranslate nohighlight">\(\text{Bern}(x)\)</span>을 다음과 같이 쓰기도 한다. <span class="math notranslate nohighlight">\(x\)</span>의 값에 0과 1을 각각 대입해보면 이 식과 위에서 쓴 식은 같은 식이라는 것을 알 수 있을 것이다.</p>
<div class="math notranslate nohighlight">
\[ \text{Bern}(x;\mu) = \mu^x(1-\mu)^{(1-x)} \]</div>
<p>만약 1과 0이 나올 확률이 같다면 다음과 같이 쓸 수 있다.</p>
<div class="math notranslate nohighlight">
\[ \text{Bern}(x;\mu) = 0.5^x0.5^{(1-x)} \]</div>
</section>
<section id="id4">
<h3><span class="section-number">2.4.1.2. </span>베르누이 분포의 시뮬레이션<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>scipy 패키지의 stats 서브패키지는 베르누이분포를 시뮬레이션할 수 있는 <code class="docutils literal notranslate"><span class="pre">bernoulli</span></code> 클래스를 제공한다. 우선 다음과 같이 모수를 지정한 클래스 인스턴스를 만든다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">bernoulli</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;scipy.stats._distn_infrastructure.rv_frozen at 0x13558cf10&gt;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pmf</span></code> 메서드를 사용하면 확률질량함수를 계산할 수 있다. 인수로는 확률변수가 가질 수 있는 값 즉, 0과 1을 넣는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="o">.</span><span class="n">pmf</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.5, 0.5])
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rvs</span></code> 메서드를 사용하면 시뮬레이션을 통해 표본을 측정할 수 있다. 인수로는 시뮬레이션 즉, 표본 개수를 넣는다. <code class="docutils literal notranslate"><span class="pre">np.random.seed</span></code> 명령은 시뮬레이션의 시드값을 설정하기 위한 것이다. 시드값이 같으면 시뮬레이션 값은 항상 동일한 값이 나온다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">samples</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">samples</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 1, 1, 1, 0, 1, 0, 1, 1, 0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">samples</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_13_0.png" src="../_images/02_04_13_0.png" />
</div>
</div>
</section>
<section id="id5">
<h3><span class="section-number">2.4.1.3. </span>베르누이분포의 예<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>위에서 이야기한대로 팁 데이터에서 성별을 나타내는 sex 데이터는 남성 또는 여성의 두 가지 값만 가지므로 베르누이분포를 따르는 확률변수다. 따라서 다음과 같이 표현할 수 있다.</p>
<div class="math notranslate nohighlight">
\[ \text{sex} \sim \text{Bern}(\text{sex};\mu_{\text{sex}}) \]</div>
<p>sex 데이터의 확률분포는 다음과 같이 시각화할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;tips&quot;</span><span class="p">)</span>

<span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;sex&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">tips</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_16_0.png" src="../_images/02_04_16_0.png" />
</div>
</div>
</section>
<section id="id6">
<h3><span class="section-number">2.4.1.4. </span>베르누이분포의 모수추정<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>베르누이분포는 확률분포함수가 고정된 수식으로 표현된 확률분포모형이므로 모수값 <span class="math notranslate nohighlight">\(\mu\)</span>만 알 수 있다면 확률분포함수를 완전히 알아내는 것이다. 그러면 베르누이분포의 모수는 다음 수식으로 추정한다. 이 식은 이후에 설명할 최대가능도추정(maximum likelihood estimation)방법을 따른 결과이다. 자세한 이론은 이후에 다루도록 한다.</p>
<div class="math notranslate nohighlight">
\[ \hat{\mu} = \dfrac{N_1}{N_1 + N_0} \]</div>
<p>이 식에서 수학기호 <span class="math notranslate nohighlight">\(\hat{\mu}\)</span>는 모수 <span class="math notranslate nohighlight">\(\mu\)</span>의 추정치를 말한다. <span class="math notranslate nohighlight">\(N_0\)</span>는 데이터 값이 0인 횟수, <span class="math notranslate nohighlight">\(N_1\)</span>은 데이터 값이 1인 횟수다. 즉, 전체 데이터 중 1이 나온 횟수의 비율이 모수 <span class="math notranslate nohighlight">\(\mu\)</span>의 추정치 <span class="math notranslate nohighlight">\(\hat{\mu}\)</span>가 된다.</p>
<p>실제로 sex 데이터의 모수를 추정해보자. 여기에서는 남자(Male)인 경우를 <span class="math notranslate nohighlight">\(x=1\)</span>인 경우라고 가정한다. 다음 코드로 <span class="math notranslate nohighlight">\(N_1=157, N_0=87\)</span>이라는 것을 알 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vc</span> <span class="o">=</span> <span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">N1</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="n">vc</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span> <span class="n">vc</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
<span class="n">N1</span><span class="p">,</span> <span class="n">N0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(157, 87)
</pre></div>
</div>
</div>
</div>
<p>따라서 모수의 추정치는 약 0.6434426229508197가 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu_hat</span> <span class="o">=</span> <span class="n">N1</span> <span class="o">/</span> <span class="p">(</span><span class="n">N1</span> <span class="o">+</span> <span class="n">N0</span><span class="p">)</span>
<span class="n">mu_hat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6434426229508197
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">normalize</span></code> 인수를 <code class="docutils literal notranslate"><span class="pre">True</span></code> 값으로 하면 한번에 계산할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Male      0.643443
Female    0.356557
Name: sex, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="id7">
<h3><span class="section-number">2.4.1.5. </span>신뢰구간<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p>이렇게 모수를 추정하였지만 아직 다음과 같은 몇가지 의문점이 남아있다.</p>
<ol class="simple">
<li><p>이 모수 추정치는 정말 정확한 값인가?</p></li>
<li><p>만약 이 모수 추정치가 정확한 값이 아니라면 어느 정도의 신뢰도를 가지는 것인가?</p></li>
</ol>
<p>첫번째 질문에 대한 답은 당연히 “아니다(No)”이다. 예를 들어 우리가 측정한 데이터의 개수가 달라지면 이 모수 추정치는 달라진다. 만약 데이터가 10개밖에 없다면 모수의 추정치는 다음과 같이 0.8이 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vc</span> <span class="o">=</span> <span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">N1</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="n">vc</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span> <span class="n">vc</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>
<span class="n">N1</span> <span class="o">/</span> <span class="p">(</span><span class="n">N1</span> <span class="o">+</span> <span class="n">N0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8
</pre></div>
</div>
</div>
</div>
<p>우리가 추정에 사용한 표본에 따라 추정치가 변하는 것을 알 수 있다. 따라서 위에서 구한 추정치는 정확한 값이라고 할 수 없다. 그렇다면 이렇게 부정확한 모수 추청치의 신뢰도는 어떻게 구할 것인가? 이 부분에 모수 추정치의 <b>신뢰구간(confidence interval)</b>이라는 것을 사용하여 구할 수 있다. 신뢰구간은 모수의 값이 특정한 확률로 그 구간 내에 있는 구간이다. 이 때 확률은 <b>유의수준(significance level)</b>이라는 수치로 지정한다. 만약 유의수준이 <span class="math notranslate nohighlight">\(\alpha\)</span>면 확률은 <span class="math notranslate nohighlight">\(1-\alpha\)</span>다. 예를 들어 5% 유의수준의 신뢰구간은 모수의 값이 95%의 확률로 그 구간 안에 있다는 뜻이다.</p>
<p>베르누이분포의 모수 <span class="math notranslate nohighlight">\(\mu\)</span>의 신뢰구간은 statsmodels 패키지의 <code class="docutils literal notranslate"><span class="pre">proportion_confint</span></code> 함수로 구할 수 있다. <code class="docutils literal notranslate"><span class="pre">proportion_confint</span></code> 함수는 3가지 인수를 가진다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">count</span></code>: 표본값이 1인 횟수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">nobs</span></code>: 전체 표본의 수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alpha</span></code>: 유의수준. 디폴트 0.05 (=5%)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: 추정방법. 다음 문자열 중 하나 <code class="docutils literal notranslate"><span class="pre">“normal”</span></code>, <code class="docutils literal notranslate"><span class="pre">“agresti_coull”</span></code>, <code class="docutils literal notranslate"><span class="pre">“beta”</span></code>, <code class="docutils literal notranslate"><span class="pre">“wilson”</span></code>, <code class="docutils literal notranslate"><span class="pre">“binom_test”</span></code>. 디폴트 <code class="docutils literal notranslate"><span class="pre">“normal”</span></code></p></li>
</ul>
<p>이 방법으로 sex 데이터의 모수의 5% 유의수준 신뢰구간을 구하면 다음과 같이 0.5833428537739491 ~ 0.7035423921276902 구간이 나온다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">statsmodels.stats.proportion</span> <span class="kn">import</span> <span class="n">proportion_confint</span>

<span class="n">vc</span> <span class="o">=</span> <span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
<span class="n">N1</span><span class="p">,</span> <span class="n">N0</span> <span class="o">=</span> <span class="n">vc</span><span class="p">[</span><span class="kc">True</span><span class="p">],</span> <span class="n">vc</span><span class="p">[</span><span class="kc">False</span><span class="p">]</span>

<span class="n">ci1</span><span class="p">,</span> <span class="n">ci2</span> <span class="o">=</span> <span class="n">proportion_confint</span><span class="p">(</span><span class="n">N1</span><span class="p">,</span> <span class="n">N0</span> <span class="o">+</span> <span class="n">N1</span><span class="p">)</span>
<span class="n">ci1</span><span class="p">,</span> <span class="n">ci2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.5833428537739491, 0.7035423921276902)
</pre></div>
</div>
</div>
</div>
</section>
<section id="id8">
<h3><span class="section-number">2.4.1.6. </span>모수검정<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p>위와 같이 신뢰구간을 구했지만 아직 남아있는 의문이 있다.</p>
<ol class="simple">
<li><p>모수의 정확한 값이 특정한 값, 예를 들어 0.5가 아닐 가능성은 어느 정도일까?</p></li>
<li><p>모수의 정확한 값을 그냥 0.6이라고 해도 될까?</p></li>
</ol>
<p>이 모수 추정치가 정확한 값이 아니라면 원래 정확한 모수는 전혀 다른 값, 예를 들어 0.6이나 0.5일 수도 있다. 그런데 표본을 측정하다보니 어쩌다 0.6434426229508197라는 값이 나온 것일 수도 있다. 그렇다면 원래의 정확한 모수의 값이 0.5인데 이렇게 어쩌다 0이 아닌 값이 나왔을 가능성은 어느 정도일까? 이 문제는 <b>모수검정(parameter testing)</b>이라는 방법으로 풀 수 있다.</p>
<p><b>검정(testing)</b>은 <b>귀무가설(null hypothesis)</b>이라고 부르는 가설이 사실인지 아닌지를 알아보는 방법이다. 그 중에서도 모수검정은 모수의 값이 특정한 값과 같을(혹은 크거나 작을) 가능성을 확인하는 방법이다. 모수검정에서 사용하는 가설 <span class="math notranslate nohighlight">\(H_0\)</span>는 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ H_0: \mu = \mu_0 \]</div>
<p><span class="math notranslate nohighlight">\(\mu_0\)</span>는 우리가 비교하려는 값이다. 예를 들어 모수의 정확한 값이 0.5라고 생각된다면 <span class="math notranslate nohighlight">\(\mu_0=0.5\)</span>이고 모수의 정확한 값이 0.6이라고 생각된다면 <span class="math notranslate nohighlight">\(\mu_0=0.6\)</span>이 된다.</p>
<p>검정을 실시하면 <b>검정통계량(test statistics)</b>과 <b>유의확률(p-value)</b>이라는 것을 계산한다.</p>
<ul class="simple">
<li><p>검정통계량: 표본 데이터 값 집합을 입력으로 계산되는 특정한 함수의 값</p></li>
<li><p>유의확률: 귀무가설이 맞을 가능성</p></li>
</ul>
<p>검정통계량은 표본 데이터 값을 특정한 함수에 모두 넣어서 계산한 값이다. 이 값을 이용하여 귀무가설이 맞을 가능성을 알려주는 유의확률을 계산한다. 만약 유의확률값이 아주 작다면, 즉 0에 가까운 값이라면 이 귀무가설은 맞을 가능성이 아주 작기 때문에 틀렸다고 생각하여 귀무가설을 <b>기각(reject)</b>하게 된다. 반대로 유의확률값이 유의수준(significance level)이라고 부르는 기준값보다 크다면 그 가설은 틀렸다고 할 수 없기 때문에 가설을 <b>채택(accept)</b>하게 된다. 보통 기준이 되는 유의수준은 5%(0.05) 혹은 1%(0.01)를 사용한다.</p>
<p>scipy 패키지의 stats 서브패키지는 베르누이모수를 검정할 수 있는 <code class="docutils literal notranslate"><span class="pre">binom_test</span></code> 함수를 제공한다. 이 함수의 인수는 다음과 같다.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code>: 데이터 표본 중 1이 나온 횟수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">n</span></code>: 데이터 표본의 개수</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>: 가설의 모수값 <span class="math notranslate nohighlight">\(\mu_0\)</span>. 디폴트 0.5</p></li>
</ul>
<p>이 함수를 이용하여 모수의 정확한 값이 0.5일 가능성을 검증해보자. 즉 귀무가설 <span class="math notranslate nohighlight">\(H_0\)</span>은 다음과 같다.</p>
<div class="math notranslate nohighlight">
\[ H_0: \mu = 0.5 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bernouilli_samples</span> <span class="o">=</span> <span class="p">(</span><span class="n">tips</span><span class="p">[</span><span class="s2">&quot;sex&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
<span class="n">bernouilli_samples</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 0,
       0, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1,
       0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1,
       1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0,
       1, 0, 1, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1, 1, 0,
       0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1,
       1, 0, 1, 0, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 0, 1, 1, 1, 1, 1, 1,
       1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 0, 1, 1, 1, 1, 1, 0,
       0, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0,
       1, 0, 1, 0, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1,
       1, 0])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binomtest</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">binomtest</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bernouilli_samples</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bernouilli_samples</span><span class="p">))</span>
<span class="n">result</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>8.74669702513338e-06
</pre></div>
</div>
</div>
</div>
<p>이 유의확률은 유의수준 1%보다 아주 작으므로 모수의 정확한 값이 0.5일 가능성은 거의 없다고 생각해도 된다.</p>
<p>이번에는 모수값을 그냥 0.6이라고 해도 되는지를 알아보자. 이 때는 인수 <code class="docutils literal notranslate"><span class="pre">p</span></code>의 값을 0.6으로 넣는다. 귀무가설 <span class="math notranslate nohighlight">\(H_0\)</span>은 다음과 같아진다.</p>
<div class="math notranslate nohighlight">
\[ H_0: \mu = 0.6 \]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">result</span> <span class="o">=</span> <span class="n">binomtest</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">bernouilli_samples</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">bernouilli_samples</span><span class="p">),</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.6</span><span class="p">)</span>
<span class="n">result</span><span class="o">.</span><span class="n">pvalue</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.17056745244373606
</pre></div>
</div>
</div>
</div>
<p>유의확률이 17%가 넘기 때문에 귀무가설을 채택한다. 즉, 0.6434426229508197이 아닌 0.6이라고 해도 무방하다는 것을 알 수 있다.</p>
</section>
</section>
<section id="id9">
<h2><span class="section-number">2.4.2. </span>이항분포<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h2>
<p>베르누이분포를 따르는 모수 <span class="math notranslate nohighlight">\(\mu\)</span>인 확률변수에서 <span class="math notranslate nohighlight">\(N\)</span>개의 표본을 얻었을 때 그 중 1인 값이 나오는 횟수의 분포를 <b>이항분포(binomial distribution)</b>라고 한다.
어떤 확률변수 <span class="math notranslate nohighlight">\(x\)</span>가 이항분포를 따를 때 다음과 같이 표시한다.</p>
<div class="math notranslate nohighlight">
\[ x \sim \text{Bin}(x) \]</div>
<p>동전을 한 번 던질 때 나오는 값은 베르누이분포를 따르므로 동전을 <span class="math notranslate nohighlight">\(N\)</span>번 던져서 앞면이 나오는 횟수는 이항분포가 된다.</p>
<p>위에서 설명한 scipy의 확률변수 시뮬레이션 기능을 통해 <span class="math notranslate nohighlight">\(N=10, \mu=0.5\)</span>인 이항분포의 표본 5개를 구해보자.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>

<span class="n">binomial_samples</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="si">}</span><span class="s2">회 이항시도:&quot;</span><span class="p">)</span>
    <span class="n">bernouilli_samples</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">binomial_sample</span> <span class="o">=</span> <span class="n">bernouilli_samples</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">binomial_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">binomial_sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;10회를 시행한 베르누이 샘플 =&quot;</span><span class="p">,</span> <span class="n">bernouilli_samples</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;베르누이 샘플 10개 중 1이 나온 횟수 =&quot;</span><span class="p">,</span> <span class="n">binomial_sample</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="mi">80</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;결론:&quot;</span><span class="p">)</span>    
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;이항분포 표본 =&quot;</span><span class="p">,</span> <span class="n">binomial_samples</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1회 이항시도:
10회를 시행한 베르누이 샘플 = [1 1 1 1 0 0 0 1 1 1]
베르누이 샘플 10개 중 1이 나온 횟수 = 7
--------------------------------------------------------------------------------
2회 이항시도:
10회를 시행한 베르누이 샘플 = [1 1 0 1 0 1 0 1 1 0]
베르누이 샘플 10개 중 1이 나온 횟수 = 6
--------------------------------------------------------------------------------
3회 이항시도:
10회를 시행한 베르누이 샘플 = [0 1 0 1 0 1 1 1 1 1]
베르누이 샘플 10개 중 1이 나온 횟수 = 7
--------------------------------------------------------------------------------
4회 이항시도:
10회를 시행한 베르누이 샘플 = [0 0 1 0 1 1 0 0 0 0]
베르누이 샘플 10개 중 1이 나온 횟수 = 3
--------------------------------------------------------------------------------
5회 이항시도:
10회를 시행한 베르누이 샘플 = [1 0 1 0 0 0 1 0 0 0]
베르누이 샘플 10개 중 1이 나온 횟수 = 3
--------------------------------------------------------------------------------
결론:
이항분포 표본 = [7, 6, 7, 3, 3]
</pre></div>
</div>
</div>
</div>
<p>여기에서는 표본을 5개만 측정하였지만 아주 많은 수의 측정을 반복한다면 어떨까? 아주 재수가 없다면 앞면이 단 한번도 나올 수 없을 것이고 아주 재수가 좋다면 10번 모두 앞면이 나올 수도 있을 것이다. 하지만 가장 확률이 높은 경우는 10번의 절반인 5번 나오는 경우일 것이다. 즉, 시행횟수가 <span class="math notranslate nohighlight">\(N\)</span>인 이항분포의 표본값은 0부터 <span class="math notranslate nohighlight">\(N\)</span>까지의 값을 가질 수 있다.</p>
<section id="id10">
<h3><span class="section-number">2.4.2.1. </span>이항분포의 확률분포함수<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<p>이항분포는 시행횟수 <span class="math notranslate nohighlight">\(N\)</span>과 베르누이모수 <span class="math notranslate nohighlight">\(\mu\)</span> 이렇게 두 개의 모수를 가진다. 시행횟수가 <span class="math notranslate nohighlight">\(N\)</span>이고 베르누이모수가 <span class="math notranslate nohighlight">\(\mu\)</span>인 이항분포의 확률분포함수 수식은 다음과 같이 구할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\text{Bin}(x;N,\mu) = \binom N x \; \mu^x(1-\mu)^{N-x}
\]</div>
<p>이 식에서 (𝑁𝑥) 기호는 <b>조합(combination)</b>이라는 기호로 <span class="math notranslate nohighlight">\(N\)</span>개 원소 중에 <span class="math notranslate nohighlight">\(x\)</span>개 원소를 순서와 상관없이 선택할 수 있는 경우의 수를 뜻한다. 조합은 다음 공식으로 계산할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\binom N x =\dfrac{N!}{x!(N-x)!}
\]</div>
<p><span class="math notranslate nohighlight">\(!\)</span> 기호는 <b>팩토리얼(factorial)</b>이라고 하며 다음처럼 정의한다.</p>
<div class="math notranslate nohighlight">
\[
N! = N\cdot (N-1) \cdots 2 \cdot 1
\]</div>
</section>
<section id="id11">
<h3><span class="section-number">2.4.2.2. </span>이항분포의 시뮬레이션<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<p>scipy 패키지의 stats 서브패키지는 이항분포를 시뮬레이션할 수 있는 <code class="docutils literal notranslate"><span class="pre">binom</span></code> 클래스를 제공한다. 사용방법은 앞에서 설명한 베르누이분포 시뮬레이션 클래스와 같다. 우선 시행횟수</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">binom</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;scipy.stats._distn_infrastructure.rv_frozen at 0x1357f7a00&gt;
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">pmf</span></code> 메서드를 사용하면 확률질량함수를 계산할 수 있다. 인수로는 확률변수가 가질 수 있는 값 즉, 0부터 <span class="math notranslate nohighlight">\(N\)</span>까지의 정수값을 넣는다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.00097656, 0.00976563, 0.04394531, 0.1171875 , 0.20507812,
       0.24609375, 0.20507812, 0.1171875 , 0.04394531, 0.00976563,
       0.00097656])
</pre></div>
</div>
</div>
</div>
<p>이 값을 그려보면 위에서 그린 것과 같은 모양이 된다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;이항분포 확률질량함수 (N=10, $\mu$=0.5)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_49_0.png" src="../_images/02_04_49_0.png" />
</div>
</div>
<p>모수값이 0.5이므로 10번 동전을 던졌을 때 1이 나오는 횟수는 위 그래프에서처럼 5번의 경우가 확률이 가장 높다. 만약 모수값이 0.5보다 작거나 커지면 이항분포의 모습은 다음과 같이 변한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$\mu=0.1$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$\mu=0.3$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$\mu=0.7$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$\mu=0.9$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;여러가지 모수값에 대한 이항분포&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_51_0.png" src="../_images/02_04_51_0.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">rvs</span></code> 메서드를 사용하면 시뮬레이션을 통해 표본을 측정할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">binomial_samples</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">binomial_samples</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 3, 6, 3, 4, 4, 6, 3, 7, 3, 8, 5, 8, 5, 6, 2, 4, 3, 4, 3, 4, 5,
       3, 6, 5, 4, 5, 3, 5, 7, 4, 6, 3, 6, 4, 4, 5, 2, 7, 1, 6, 4, 6, 8,
       4, 5, 5, 5, 4, 8, 5, 7, 6, 4, 6, 5, 7, 5, 7, 6, 6, 5, 8, 6, 5, 5,
       2, 4, 6, 4, 5, 5, 3, 4, 5, 5, 5, 6, 6, 5, 7, 4, 5, 7, 6, 6, 3, 7,
       6, 9, 3, 7, 3, 5, 3, 7, 6, 5, 5, 3])
</pre></div>
</div>
</div>
</div>
<p>numpy 패키지의 <code class="docutils literal notranslate"><span class="pre">bincount</span></code> 함수를 사용하면 이항함수 표본에서 각 값이 나온 횟수를 카운트할 수 있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">binomial_samples</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0,  1,  3, 16, 17, 26, 20, 11,  5,  1,  0])
</pre></div>
</div>
</div>
</div>
<p>이론적인 확률질량함수와 시뮬레이션 결과를 비교하면 다음 그림과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">binomial_samples</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">binomial_samples</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;이론&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s2">&quot;시뮬레이션&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;표본값&quot;</span><span class="p">,</span> <span class="s2">&quot;유형&quot;</span><span class="p">,</span> <span class="s2">&quot;비율&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="s2">&quot;표본값&quot;</span><span class="p">,</span> <span class="s2">&quot;유형&quot;</span><span class="p">,</span> <span class="s2">&quot;비율&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;표본값&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;비율&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;유형&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;이항분포의 이론적 분포와 시뮬레이션 분포&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_57_0.png" src="../_images/02_04_57_0.png" />
</div>
</div>
</section>
<section id="id12">
<h3><span class="section-number">2.4.2.3. </span>이항분포와 베르누이분포의 비교<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<p>지금까지 설명했듯이 이항분포를 따르는 확률변수 <span class="math notranslate nohighlight">\(y\)</span>는 베르누이분포를 따르는 확률변수 <span class="math notranslate nohighlight">\(x\)</span>에서 파생된 확률변수다. 이항분포와 베르누이분포 사이에는 다음과 같은 관계가 성립한다.</p>
<ol class="simple">
<li><p>베르누이분포를 따른 확률변수 <span class="math notranslate nohighlight">\(x\)</span>의 표본 <span class="math notranslate nohighlight">\(N\)</span>개를 모으면 이항분포를 따르는 확률변수 <span class="math notranslate nohighlight">\(y\)</span>의 표본 한 개가 얻어진다.</p></li>
<li><p>베르누이분포의 모수 <span class="math notranslate nohighlight">\(\mu_x\)</span>와 이 베르누이분포에서 파생된 이항분포의 모수 <span class="math notranslate nohighlight">\(\mu_y\)</span>는 같다.</p></li>
<li><p>시행횟수 <span class="math notranslate nohighlight">\(N=1\)</span>인 이항분포는 베르누이분포다.</p></li>
</ol>
</section>
<section id="id13">
<h3><span class="section-number">2.4.2.4. </span>이항분포의 예<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<p>식당 팁 데이터에서 sex 필드 데이터는 베르누이분포를 따르는 확률변수의 표본이라고 하였다. sex 필드 데이터의 레코드는 전체가 244개이므로 전체 sex 필드 데이터에서 남성이 있는 레코드의 수는 <span class="math notranslate nohighlight">\(N=244\)</span>인 이항분포를 따르는 확률변수의 표본이 된다. 이 표본값은 157이다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">tips</span><span class="p">),</span> <span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(244, 157)
</pre></div>
</div>
</div>
</div>
<p>만약 sex 필드 데이터를 4개씩 묶어서 4개 중 남성이 있는 레코드의 개수를 센다면 이는 <span class="math notranslate nohighlight">\(N=4\)</span>인 이항분포를 따르는 확률변수의 표본이라고 할 수 있다. 실제로 이 방법으로 남성이 나오는 횟수를 세면 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sex_counts</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)))</span>
<span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">sex_counts</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0     3
1     3
2     3
3     3
4     2
     ..
56    2
57    3
58    4
59    3
60    2
Length: 61, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">sex_counts</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;4개 팀 중 &#39;sex=Male&#39;인 경우의 수&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_65_0.png" src="../_images/02_04_65_0.png" />
</div>
</div>
<p>위에서 sex 데이터의 베르누이모수는 약 0.643이라고 추정하였다. 이 모수값은 이항분포에도 그대로 적용되므로 <span class="math notranslate nohighlight">\(N=4, \mu=0.643\)</span>인 이항분포의 확률질량함수를 그리면 다음과 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mf">0.643</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">N</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">mu</span><span class="p">)</span>
<span class="n">xx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">xx</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;$N=4, \mu=0.643$인 이항분포의 확률질량함수&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_67_0.png" src="../_images/02_04_67_0.png" />
</div>
</div>
<p>두 그래프를 비교하면 아래와 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.01624325, 0.11702418, 0.31616197, 0.37963053, 0.17094008])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">bincount</span><span class="p">(</span><span class="n">sex_counts</span><span class="p">,</span> <span class="n">minlength</span><span class="o">=</span><span class="n">N</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sex_counts</span><span class="p">))</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;이론&quot;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span> <span class="s2">&quot;시뮬레이션&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;표본값&quot;</span><span class="p">,</span> <span class="s2">&quot;유형&quot;</span><span class="p">,</span> <span class="s2">&quot;비율&quot;</span><span class="p">]</span>
<span class="n">df</span><span class="o">.</span><span class="n">pivot</span><span class="p">(</span><span class="s2">&quot;표본값&quot;</span><span class="p">,</span> <span class="s2">&quot;유형&quot;</span><span class="p">,</span> <span class="s2">&quot;비율&quot;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">barplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;표본값&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;비율&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;유형&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;이항분포의 이론적 분포와 시뮬레이션 분포&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/02_04_70_0.png" src="../_images/02_04_70_0.png" />
</div>
</div>
</section>
<section id="id14">
<h3><span class="section-number">2.4.2.5. </span>이항분포의 모수추정<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h3>
<p>이항분포의 모수는 시행횟수 <span class="math notranslate nohighlight">\(N\)</span>과 베르누이모수 <span class="math notranslate nohighlight">\(\mu\)</span>다. 이항분포의 모수추정 문제는 다음과 같은 두 가지가 있을 수 있다.</p>
<ol class="simple">
<li><p>시행횟수 <span class="math notranslate nohighlight">\(N\)</span>을 정확하게 알고 있고 베르누이모수 <span class="math notranslate nohighlight">\(\mu\)</span>만 추정해야 하는 경우</p></li>
<li><p>시행횟수 <span class="math notranslate nohighlight">\(N\)</span>과 베르누이모수 <span class="math notranslate nohighlight">\(\mu\)</span>를 모두 추정해야 하는 경우</p></li>
</ol>
<p>만약 시행횟수 <span class="math notranslate nohighlight">\(N\)</span>을 정확하게 알고 있다면 <span class="math notranslate nohighlight">\(M\)</span>개의 이항분포 표본값으로부터 베르누이 모수는 다음과 같이 추정할 수 있다.</p>
<div class="math notranslate nohighlight">
\[
\hat{\mu} = \dfrac{\sum_{i=1}^M y_i}{MN}
\]</div>
<p>만약 sex 데이터에서 전체 레코드 중 남성의 수를 <span class="math notranslate nohighlight">\(N=244\)</span>인 이항분포의 표본으로 본다면 모수는 다음과 같이 추정한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">tips</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6434426229508197
</pre></div>
</div>
</div>
</div>
<p>만약 sex 데이터를 4개의 레코드씩 묶어서 각 그룹의 남성 수를 <span class="math notranslate nohighlight">\(N=4\)</span>인 이항분포의 표본으로 본다면 모수는 다음과 같이 추정한다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array_split</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tips</span><span class="o">.</span><span class="n">sex</span><span class="p">)</span> <span class="o">/</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">y_i</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="s2">&quot;Male&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span> <span class="n">groups</span><span class="p">))</span>
<span class="n">sum_y_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y_i</span><span class="p">)</span>
<span class="n">sum_y_i</span> <span class="o">/</span> <span class="p">(</span><span class="n">M</span> <span class="o">*</span> <span class="n">N</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6434426229508197
</pre></div>
</div>
</div>
</div>
<p>두 방법 모두 동일한 값을 추정하고 있는 것을 알 수 있다.</p>
<p>시행횟수 <span class="math notranslate nohighlight">\(N\)</span>을 알지 못하는 경우에는 distfit 패키지를 이용할 수 있다. distfit 패키지는 다음 명령으로 설치한다.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">distfit</span>
</pre></div>
</div>
<p>사용방법은 다음 코드와 같다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">distfit</span> <span class="kn">import</span> <span class="n">distfit</span>

<span class="n">dist</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;discrete&#39;</span><span class="p">,</span> <span class="n">distr</span><span class="o">=</span><span class="s2">&quot;binom&quot;</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sex_counts</span><span class="p">))[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[distfit] &gt;fit..
[distfit] &gt;transform..
[distfit] &gt;Fit using binomial distribution..
[distfit] &gt;[binomial] [RSS=0.00428] [n=4] [p=0.664505] [chi^2=0.00143]
[distfit] &gt;Compute confidence interval [discrete]
</pre></div>
</div>
</div>
</div>
<p>계산결과인 model 객체는 파이썬 dict 타입 객체다. <code class="docutils literal notranslate"><span class="pre">n</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code> 키에는 각각 <span class="math notranslate nohighlight">\(N\)</span>, <span class="math notranslate nohighlight">\(\mu\)</span> 추정치가 들어있다.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;n&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="p">[</span><span class="s2">&quot;p&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6645045188248099
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./ch02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="02_03.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">2.3. </span>확률분포모형을 사용한 확률분포추정</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="02_05.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">2.5. </span>카테고리분포와 다항분포</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By 김도형<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>